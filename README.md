# Это репозиторий для учебных проектов на Airflow, а также некоторых других заданий по Python

## Задания на Airflow

### Задание 1.
Развернуть локально Airflow и написать простой DAG с чтением данных из csv файла, обработкой, очисткой и выгрузкой в новый файл

### Задание 2.
Написать DAG Airflow, тасками которого будут следующие функции (город можно взять любой): 
1. Получение данных обо всех зданиях в городе и геометрии самого города с помощью библиотек osmnx и geopands, а также сохранение данных в отдельные файлы buildings.geojson, city_geometry.geojson
2. Получение данных о больницах в городе с сохранением в отдельный файл
3. Определение количества домов, которые приходятся на каждую больницу в радиусе 500 метров (тут можно считать расстояние от точки до точки напрямую)
4. Отрисовка графика с самыми загруженными больницами и его сохранение в файл

### Задание 3.
Реализовать сервис, который запускает sql скрипты. Скрипты (достаточно написать по одному) лежат в двух директориях. 
- Первая - скрипты для чтения csv файлов, их обработки
- Вторая - скрипты предназначенные для чтения parquet файлов, удаления дубликатов, а также исключения из результирующего набора данных тех id, которые присутствуют в справочнике errors.txt (создать самому)

Каждый понедельник нужно брать csv, читать и записывать результат (append'ом) в delta формате.
Раз в месяц необходимо витрину, рассчитанную по средам, обрабатывать и записывать результат.
Оркестрацию производить с помощью Airflow.


## Задания Python

### Задание 1.
Напишите функцию, которая принимает DataFrame и возвращает имена двух столбцов с наибольшей положительной корреляцией.

### Задание 2.
Напишите Python-скрипт, который принимает путь к большому CSV-файлу и подсчитывает количество строк (записей) в файле без загрузки его целиком в память. Скрипт должен быть оптимизирован для работы с большими файлами.

### Задание 3.
Напишите функцию, которая принимает список чисел и возвращает все значения, которые являются выбросами. Выбросы определяются как значения, которые находятся ниже первого квартиля (Q1) минус 1.5 * IQR или выше третьего квартиля (Q3) плюс 1.5 * IQR, где IQR — межквартильный размах.

### Задание 4.
Напишите функцию, которая принимает DataFrame и заменяет отсутствующие значения (NaN) в каждом числовом столбце на более подходящие значения (здесь стоит использовать группировки по нескольким столбцам, чтобы получить наиболее реалистичные данные). Если столбец содержит только NaN, оставьте его без изменений.


## Файловая структура

### `dags` 
Папка, в которой хранятся все даги и сопутствующие им файлы для выполнения заданий по Airflow.
В ней лежат:

- `first` - папка для первого задания
  - `input` - папка с входными данными для первого задания
  - `output` - папка с выходными данными для первого задания
  - `first.py` - даг для первого задания
- `second` - папка для второго задания

### `python_tasks`
Папка, в которой хранятся все скрипты для выполнения заданий по Python

- `first` - папка для первого задания
  - `correlations.ipynb` - Jupyter Notebook с пояснениями к функции
  - `correlations.py` - скрипт с функцией
- `second` - папка для второго задания
  - `input.csv` - большой csv файл для проверки работы функции (настолько большой, что git не хочет его хранить)
  - `rows_count.ipynb` - Jupyter Notebook с пояснениями к функции
  - `rows_count.py` - скрипт с функцией
